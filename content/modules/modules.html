<div class="contained contained-modules hidden">
<div class="title"><span class="menu-icon material-symbols-outlined">menu</span>Modules</div>
<div class="para">
	Deployer has a very modular architecture.  So much so, that if you strip away all the modules,
	it is not even a deployer - it knows nothing about targets, and can do no work.  All of the
	functionality is contained in the modules.  The core of the system (the driver) knows how to
	parse files and nothing else.
</div>
<div class="para">
	The modularity works by using a set of extension points.  The main driver defines four of these
	(as shown below) and modules can define more as needed.  The core module defines five more, which
	define the core of how deployment works.  Other modules then provide implementations on offer for
	these extension points.
</div>
<div class="para">
	In each of the sections that follows, the module will describe the extensions it provides, grouped
	by the extension point names.
</div>
<h2>Extension Points</h2>
<div class="para">
	<span class='code'>main-args</span> - this extension point identifies the main entry point of the
	program, which will be responsible for processing arguments.  Only one definition of this extension
	point is permitted.
</div>
<div class="para">
	<span class='code'>top-level</span> - this extension point allows modules to provide verb handlers for
	specific verb names at the top level of the file.
</div>
<div class="para">
	<span class='code'>attacher</span> - this extension point allows items to be attached to the top level
	of the parse tree.  Most elements are attached to an "immediate parent", but top level elements do not
	have a parent; this code is used to handle that.
</div>
<div class="note">
	At the time of writing, this is not properly supported, since the only valid top level form is the
	<span class='code'>target</span>.
</div>
<div class="para">
	<span class='code'>prop-interpreter</span> - this extension point allows modules to attach additional
	handlers into the property interpreter flow.
</div>
<div class="para">
	<span class='code'>function-defn</span> - this extension point allows modules to provide function definitions.
	The base driver code already includes basic definitions, listed below.
</div>
<h2>Interpreters</h2>
<div class="para">
	Deployer uses a very strict indentation rule for interpreting files.  Lines with text in the first column
	are treated as commentary and are ignored for all practical purposes.  Otherwise, every line must have a 
	whitespace indentation which is consistent with each of the previous lines with equal or less nesting.  Users
	may choose any combination of tabs and spaces, but must make the same choice for each active level of nesting.
	Scopes can then be identified numerically by how many ancestors (active lines with less nesting) they have.
</div>
<div class="para">
	After handling the indentation, the driver parser breaks each line into a list of tokens, and handles any
	variable assignment that may be present.  The remaining tokens then
	need to be handled in a way appropriate to the scope (level of indentation and indentation context).
</div>
<div class="para">
	Lines at the top level are always interpreted using the <span class='code'>verb</span> interpreter and the
	acceptable verbs are those attached to the <span class='code'>top-level</span> extension point; subsequently,
	each chosen handler is required to return an appropriate interpreter for its nested content.
</div>
<div class="para">
	<span class='code'>verb</span> - this interpreter looks at the first token it receives and requires that it
	be an <span class='code'>identifier</span>.  It has a dictionary of acceptable verbs and selects the handler that
	matches.  If no handler matches, it reports an error and returns the <span class='code'>ignore</span> interpreter.
</div>
<div class="para">
	<span class='code'>properties</span> - this interpreter looks for patterns of the form <span class='code'>a &lt;- b</span>
	and calls the parent scope with a property definition.  It also handles the nested case <span class='code'>a &lt;= handler</span>
	where <span class='code'>handler</span> is the name of an interpreter defined in the scope which reads the nested
	scope in order to produce a property value.
</div>
<div class="para">
	The property interpreter also handles <span class='code'>adverbs</span>.  Any adverb token will be passed, along
	with its argument, to an enclosing scope handler.
</div>
<div class="para">
	<span class='code'>ignore</span> - this interpreter simply ignores all content and returns itself.  This is
	mainly useful to avoid cascading errors: when a handler encounters an error, it can report it directly and then
	return this interpreter to avoid having additional (usually spurious) errors be reported to the user.
</div>
<div class="para">
	<span class='code'>disallow</span> - this interpreter simply raises an error that content cannot appear here
	and then ignores all nested content.
</div>
<h2>Builtin Function Definitions</h2>
<div class="para">
	<span class='code'>-&gt;</span> - method invocations are performed using the invoke operator <span class='code'>-&gt;</span>.
	This is defined at the driver level.  It is an infix operator with precedence 10 and left associative; it accepts
	one prior parameter (the object) and requires at least one post parameter (the method name).  Any additional
	post parameters are passed to the method invocation as arguments.
</div>
<div class="para">
	<span class='code'>+</span> - an infix operator with precedence 5 which is left associative.  It takes one prior
	and one post parameter and adds them together.
</div>
<div class="para">
	<span class='code'>-</span> - an infix operator with precedence 5 which is left associative.  It takes one prior
	and one post parameter and subtracts the second from the first.
</div>
<div class="para">
	<span class='code'>*</span> - an infix operator with precedence 6 which is left associative.  It takes one prior
	and one post parameter and multiplies them together.
</div>
<div class="para">
	<span class='code'>/</span> - an infix operator with precedence 6 which is left associative.  It takes one prior
	and one post parameter and divides the first by the second.
</div>
<div class="para">
	<span class='code'>sum</span> - a prefix function with precedence 1 which is right associative. It takes zero or
	more numeric arguments and produces	the sum of all of them.
</div>
<h2>Builtin Symbol Definitions</h2>
<div class="para">
	<span class='code'>true</span> - a constant defined to have the numeric value 1.
</div>
<div class="para">
	<span class='code'>false</span> - a constant defined to have the numeric value 0.
</div>
<div class="note">
	At the time of writing, these exist outside the normal extension point mechanism.  There probably should be an
	extension point for <span class='code'>constant-defn</span> or some such, but it is not entirely clear how it should
	work.
</div>
</div>